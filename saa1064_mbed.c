#include "saa1064_mbed.h"

void led_ctrl(uint8_t dyn, uint8_t en13, uint8_t ent24) {
	uint8_t txd[2];
	txd[0] = 0x00; //control word
	txd[1] = dyn | (en13 << 1) | (en24 << 2) | 0x50; //control byte to write.
	i2c_transfer(txd, 2, NULL, 0, LED_ADDR);
}

void led_test() {
	uint8_t txd[2];
	txd[0] = 0x00; //control word
	txd[1] = 0x5F; //dynamic mode, all segments on.
	i2c_transfer(txd, 2, NULL, 0, LED_ADDR);
}

void led_digit(uint8_t val, uint8_t dig, uint8_t dp) {
	uint8_t txd[2];
	txd[0] = dig;
	
		switch (val) {
		case 0:
			txd[1] = 0x01 | 0x02 | 0x04 | 0x08 | 0x10 | 0x20;
			break;
		case 1:
			txd[1] = 0x02 | 0x04;
			break;
		case 2:
			txd[1] = 0x01 | 0x02 | 0x40 | 0x10 | 0x08;
			break;
		case 3:
			txd[1] = 0x01 | 0x02 | 0x40 | 0x04 | 0x08;
			break;
		case 4:
			txd[1] = 0x20 | 0x40 | 0x02 | 0x04;
			break;
		case 5:
			txd[1] = 0x01 | 0x20 | 0x40 | 0x04 | 0x08;
			break;
		case 6:
			txd[1] = 0x01 | 0x20 | 0x40 | 0x10 | 0x08 | 0x04;
			break;
		case 7:
			txd[1] = 0x01 | 0x02 | 0x04;
			break;
		case 8:
			txd[1] = 0x01 | 0x20 | 0x40 | 0x10 | 0x08 | 0x04 | 0x02;
			break;
		case 9:
			txd[1] = 0x01 | 0x20 | 0x40 | 0x08 | 0x04 | 0x02;
			break;
		case 0x0A:
			txd[1] = 0x01 | 0x20 | 0x40 | 0x10 | 0x04 | 0x02;
			break;
		case 0x0B:
			txd[1] = 0x20 | 0x40 | 0x10 | 0x08 | 0x04;
			break;
		case 0x0C:
			txd[1] = 0x01 | 0x20 | 0x10 | 0x08;
			break;
		case 0x0D:
			txd[1] = 0x02 | 0x40 | 0x10 | 0x08 | 0x04;
			break;
		case 0x0E:
			txd[1] = 0x01 | 0x20 | 0x40 | 0x10 | 0x08;
			break;
		case 0x0F:
			txd[1] = 0x01 | 0x20 | 0x40 | 0x10;
			break;
	}
	
	if (dp) {
		txd[1] |= 0x80;	
	}
	i2c_transfer(txd, 2, NULL, 0, LED_ADDR);
}

